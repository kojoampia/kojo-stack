{"ast":null,"code":"/**\n * Generate a random 32-character hex string for trace/span IDs\n */\nfunction generateId() {\n  let id = '';\n  for (let i = 0; i < 16; i++) {\n    id += Math.floor(Math.random() * 16).toString(16);\n  }\n  return id;\n}\n/**\n * Generate W3C Trace Context compliant traceparent header\n * Format: 00-{trace-id}-{span-id}-{trace-flags}\n */\nfunction generateTraceContext() {\n  const traceId = generateId();\n  const spanId = generateId().substring(0, 16);\n  const traceFlags = '01'; // Sampled=true\n  const traceparent = `00-${traceId}-${spanId}-${traceFlags}`;\n  return {\n    traceparent,\n    traceId\n  };\n}\n/**\n * HTTP Interceptor that adds W3C Trace Context headers to all HTTP requests.\n */\nexport const traceIdInterceptor = (req, next) => {\n  const {\n    traceparent,\n    traceId\n  } = generateTraceContext();\n  const clonedRequest = req.clone({\n    setHeaders: {\n      'traceparent': traceparent,\n      'X-Trace-Id': traceId,\n      'X-B3-TraceId': traceId,\n      'X-B3-SpanId': traceId.substring(0, 16),\n      'X-B3-Sampled': '1'\n    }\n  });\n  if (req.method !== 'GET') {\n    console.debug(`[TRACE-${traceId}] ${req.method} ${req.url}`);\n  }\n  return next(clonedRequest);\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}