{"ast":null,"code":"import * as i0 from \"@angular/core\";\n/**\n * HTTP Interceptor that adds W3C Trace Context headers to all HTTP requests\n * for distributed tracing with OpenTelemetry backend integration\n *\n * Follows W3C Trace Context standard:\n * - traceparent: 00-{trace-id}-{span-id}-{trace-flags}\n * - tracestate: optional vendor-specific trace state\n */\nexport let TraceIdInterceptor = /*#__PURE__*/(() => {\n  class TraceIdInterceptor {\n    /**\n     * Generate a random 32-character hex string for trace/span IDs\n     */\n    generateId() {\n      let id = '';\n      for (let i = 0; i < 16; i++) {\n        id += Math.floor(Math.random() * 16).toString(16);\n      }\n      return id;\n    }\n    /**\n     * Generate W3C Trace Context compliant traceparent header\n     * Format: 00-{trace-id}-{span-id}-{trace-flags}\n     * - version: 00 (current version)\n     * - trace-id: 32 hex chars\n     * - span-id: 16 hex chars\n     * - trace-flags: 01 (sampled) or 00 (not sampled)\n     */\n    generateTraceContext() {\n      const traceId = this.generateId();\n      const spanId = this.generateId().substring(0, 16); // 16 hex chars for span\n      const traceFlags = '01'; // Sampled=true for all requests\n      const traceparent = `00-${traceId}-${spanId}-${traceFlags}`;\n      return {\n        traceparent,\n        traceId\n      };\n    }\n    intercept(request, next) {\n      // Generate W3C compliant trace context\n      const {\n        traceparent,\n        traceId\n      } = this.generateTraceContext();\n      // Clone the request and add W3C Trace Context headers\n      const clonedRequest = request.clone({\n        setHeaders: {\n          // W3C Trace Context standard headers (primary)\n          'traceparent': traceparent,\n          // Optional: Custom header for additional tracking\n          'X-Trace-Id': traceId,\n          // B3 headers for backward compatibility with B3 propagators\n          'X-B3-TraceId': traceId,\n          'X-B3-SpanId': traceId.substring(0, 16),\n          'X-B3-Sampled': '1'\n        }\n      });\n      // Log the trace ID for debugging (optional)\n      if (request.method !== 'GET') {\n        console.debug(`[TRACE-${traceId}] ${request.method} ${request.url}`);\n      }\n      // Forward the modified request\n      return next.handle(clonedRequest);\n    }\n    static {\n      this.ɵfac = function TraceIdInterceptor_Factory(t) {\n        return new (t || TraceIdInterceptor)();\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: TraceIdInterceptor,\n        factory: TraceIdInterceptor.ɵfac\n      });\n    }\n  }\n  return TraceIdInterceptor;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}