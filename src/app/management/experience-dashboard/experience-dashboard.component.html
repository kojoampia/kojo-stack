<div class="model-dashboard">
  <!-- Back to Admin Button -->
  <div class="nav-header">
    <a routerLink="/management" class="btn btn-back">
      ‚Üê Back to Admin Dashboard
    </a>
  </div>

  <!-- Header -->
  <div class="dashboard-header">
    <h1>üíº {{ modelName }} Management</h1>
    <button 
      class="btn btn-primary" 
      (click)="createItem()"
      [disabled]="loading">
      + Add New {{ modelName }}
    </button>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="alert alert-error">
    {{ error }}
    <button class="close-btn" (click)="error = null">√ó</button>
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    Loading...
  </div>

  <!-- List View -->
  <div *ngIf="currentAction === 'list' && !loading" class="list-view">
    <div *ngIf="items.length === 0" class="empty-state">
      <p>No {{ modelName | lowercase }}s found</p>
      <button class="btn btn-primary" (click)="createItem()">Create First {{ modelName }}</button>
    </div>

    <div class="items-grid" *ngIf="items.length > 0">
      <div class="item-card" *ngFor="let item of items" [class.selected]="selectedItem?.id === item.id">
        <div class="card-header">
          <span class="badge" [ngClass]="getStatusClass(item.status)">{{ item.status }}</span>
          <span class="period">{{ item.period }}</span>
        </div>
        <div class="card-body">
          <h3>{{ item.company }}</h3>
          <p class="role">{{ item.role }}</p>
          <p class="description">{{ item.description | slice:0:100 }}{{ item.description.length > 100 ? '...' : '' }}</p>
          <div class="tech-stack">
            <span class="tech-tag" *ngFor="let tech of item.stack | slice:0:4">{{ tech }}</span>
            <span class="tech-tag more" *ngIf="item.stack.length > 4">+{{ item.stack.length - 4 }}</span>
          </div>
        </div>
        <div class="card-metrics" *ngIf="item.metrics && item.metrics.length > 0">
          <div class="metric" *ngFor="let metric of item.metrics | slice:0:2">
            <span class="metric-label">{{ metric.label }}</span>
            <span class="metric-value" [ngClass]="'trend-' + metric.trend">{{ metric.value }}</span>
          </div>
        </div>
        <div class="card-actions">
          <button class="btn btn-sm btn-view" (click)="viewItem(item)">View</button>
          <button class="btn btn-sm btn-info" (click)="editItem(item)">Edit</button>
          <button class="btn btn-sm btn-danger" (click)="deleteItem(item)">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Detail View -->
  <div *ngIf="isViewing && detailItem" class="detail-view">
    <div class="detail-header">
      <h2>{{ detailItem.company }}</h2>
      <span class="badge" [ngClass]="getStatusClass(detailItem.status)">{{ detailItem.status }}</span>
    </div>
    
    <div class="detail-content">
      <div class="detail-section">
        <label>Role</label>
        <p>{{ detailItem.role }}</p>
      </div>
      
      <div class="detail-section">
        <label>Period</label>
        <p>{{ detailItem.period }}</p>
      </div>
      
      <div class="detail-section">
        <label>Description</label>
        <p>{{ detailItem.description }}</p>
      </div>
      
      <div class="detail-section">
        <label>Tech Stack</label>
        <div class="tech-stack">
          <span class="tech-tag" *ngFor="let tech of detailItem.stack">{{ tech }}</span>
        </div>
      </div>
      
      <div class="detail-section" *ngIf="detailItem.metrics && detailItem.metrics.length > 0">
        <label>Metrics</label>
        <div class="metrics-grid">
          <div class="metric-card" *ngFor="let metric of detailItem.metrics">
            <span class="metric-label">{{ metric.label }}</span>
            <span class="metric-value" [ngClass]="'trend-' + metric.trend">{{ metric.value }}</span>
            <span class="trend-indicator" [ngClass]="'trend-' + metric.trend">
              {{ metric.trend === 'up' ? '‚Üë' : metric.trend === 'down' ? '‚Üì' : '‚Üí' }}
            </span>
          </div>
        </div>
      </div>
    </div>
    
    <div class="detail-actions">
      <button class="btn btn-info" (click)="editItem(detailItem)">Edit</button>
      <button class="btn btn-secondary" (click)="cancelAction()">Back to List</button>
    </div>
  </div>

  <!-- Create/Update Form -->
  <div *ngIf="(isCreating || isUpdating) && !loading" class="form-view">
    <div class="form-header">
      <h2>{{ isCreating ? 'Create' : 'Edit' }} {{ modelName }}</h2>
    </div>

    <form class="form">
      <div class="form-row">
        <div class="form-group">
          <label for="company">Company *</label>
          <input 
            id="company" 
            type="text" 
            class="form-control" 
            [(ngModel)]="formData.company"
            name="company"
            placeholder="e.g., Accenture"
            required>
        </div>

        <div class="form-group">
          <label for="role">Role *</label>
          <input 
            id="role" 
            type="text" 
            class="form-control" 
            [(ngModel)]="formData.role"
            name="role"
            placeholder="e.g., Senior DevOps Engineer"
            required>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="period">Period *</label>
          <input 
            id="period" 
            type="text" 
            class="form-control" 
            [(ngModel)]="formData.period"
            name="period"
            placeholder="e.g., 06/2022 - 08/2023">
        </div>

        <div class="form-group">
          <label for="status">Status</label>
          <select 
            id="status" 
            class="form-control" 
            [(ngModel)]="formData.status"
            name="status">
            <option *ngFor="let status of statusOptions" [value]="status">{{ status }}</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label for="description">Description</label>
        <textarea 
          id="description" 
          class="form-control" 
          [(ngModel)]="formData.description"
          name="description"
          rows="4"
          placeholder="Describe the role and key achievements..."></textarea>
      </div>

      <div class="form-group">
        <label for="stack">Tech Stack (comma-separated)</label>
        <input 
          id="stack" 
          type="text" 
          class="form-control" 
          [(ngModel)]="stackInput"
          name="stack"
          placeholder="e.g., Java 21, Spring Boot, Kubernetes, Docker">
      </div>

      <div class="form-group">
        <label>Metrics</label>
        <div class="metrics-editor">
          <div class="metric-input-row">
            <input 
              type="text" 
              class="form-control" 
              [(ngModel)]="newMetric.label"
              name="metricLabel"
              placeholder="Label (e.g., Uptime)">
            <input 
              type="text" 
              class="form-control" 
              [(ngModel)]="newMetric.value"
              name="metricValue"
              placeholder="Value (e.g., 99.9%)">
            <select class="form-control" [(ngModel)]="newMetric.trend" name="metricTrend">
              <option value="up">‚Üë Up</option>
              <option value="down">‚Üì Down</option>
              <option value="stable">‚Üí Stable</option>
            </select>
            <button type="button" class="btn btn-sm btn-primary" (click)="addMetric()">Add</button>
          </div>
          <div class="metrics-list" *ngIf="formData.metrics && formData.metrics.length > 0">
            <div class="metric-item" *ngFor="let metric of formData.metrics; let i = index">
              <span>{{ metric.label }}: {{ metric.value }} ({{ metric.trend }})</span>
              <button type="button" class="btn btn-sm btn-danger" (click)="removeMetric(i)">√ó</button>
            </div>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-primary" (click)="saveItem()">Save</button>
        <button type="button" class="btn btn-secondary" (click)="cancelAction()">Cancel</button>
      </div>
    </form>
  </div>

  <!-- Delete Confirmation -->
  <div *ngIf="isDeleting && !loading" class="delete-confirmation">
    <div class="confirmation-dialog">
      <h2>Delete {{ modelName }}</h2>
      <p>Are you sure you want to delete this experience?</p>
      <p class="item-info">{{ selectedItem?.company }} - {{ selectedItem?.role }}</p>
      
      <div class="confirmation-actions">
        <button class="btn btn-danger" (click)="confirmDelete()">Delete</button>
        <button class="btn btn-secondary" (click)="cancelAction()">Cancel</button>
      </div>
    </div>
  </div>
</div>
